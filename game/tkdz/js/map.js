"use strict";var Map=function Map(wCtx,gCtx){this.level=1,this.mapLevel=null,this.wallCtx=wCtx,this.grassCtx=gCtx,this.offsetX=32,this.offsetY=16,this.wTileCount=26,this.HTileCount=26,this.tileSize=16,this.homeSize=32,this.num=new Num(this.wallCtx),this.mapWidth=416,this.mapHeight=416,this.setMapLevel=function(level){this.level=level;var tempMap=eval("map"+this.level);this.mapLevel=new Array;for(var i=0;i<tempMap.length;i++){this.mapLevel[i]=new Array;for(var j=0;j<tempMap[i].length;j++)this.mapLevel[i][j]=tempMap[i][j]}},this.draw=function(){this.wallCtx.fillStyle="#7f7f7f",this.wallCtx.fillRect(0,0,SCREEN_WIDTH,SCREEN_HEIGHT),this.wallCtx.fillStyle="#000",this.wallCtx.fillRect(this.offsetX,this.offsetY,this.mapWidth,this.mapHeight),this.grassCtx.clearRect(0,0,SCREEN_WIDTH,SCREEN_HEIGHT);for(var t=0;t<this.HTileCount;t++)for(var i=0;i<this.wTileCount;i++)this.mapLevel[t][i]==WALL||this.mapLevel[t][i]==GRID||this.mapLevel[t][i]==WATER||this.mapLevel[t][i]==ICE?this.wallCtx.drawImage(RESOURCE_IMAGE,this.tileSize*(this.mapLevel[t][i]-1)+POS.map[0],POS.map[1],this.tileSize,this.tileSize,i*this.tileSize+this.offsetX,t*this.tileSize+this.offsetY,this.tileSize,this.tileSize):this.mapLevel[t][i]==GRASS?this.grassCtx.drawImage(RESOURCE_IMAGE,this.tileSize*(this.mapLevel[t][i]-1)+POS.map[0],POS.map[1],this.tileSize,this.tileSize,i*this.tileSize+this.offsetX,t*this.tileSize+this.offsetY,this.tileSize,this.tileSize):this.mapLevel[t][i]==HOME&&this.wallCtx.drawImage(RESOURCE_IMAGE,POS.home[0],POS.home[1],this.homeSize,this.homeSize,i*this.tileSize+this.offsetX,t*this.tileSize+this.offsetY,this.homeSize,this.homeSize);this.drawNoChange(),this.drawEnemyNum(maxEnemy),this.drawLevel(),this.drawLives(0,1),this.drawLives(0,2)},this.drawNoChange=function(){this.wallCtx.drawImage(RESOURCE_IMAGE,POS.score[0],POS.score[1],30,32,464,256,30,32),this.wallCtx.drawImage(RESOURCE_IMAGE,30+POS.score[0],POS.score[1],30,32,464,304,30,32),this.wallCtx.drawImage(RESOURCE_IMAGE,60+POS.score[0],POS.score[1],30,32,464,352,32,30)},this.drawLevel=function(){this.num.draw(this.level,468,384)},this.drawEnemyNum=function(t){for(var i=1;i<=t;i++){var e=466,s=34+16*parseInt((i+1)/2);i%2==0&&(e=482),this.wallCtx.drawImage(RESOURCE_IMAGE,92+POS.score[0],POS.score[1],14,14,e,s,14,14)}},this.clearEnemyNum=function(t,i){var e=34+this.offsetY;if(!(i<=0)){this.wallCtx.fillStyle="#7f7f7f";var s=466+i%2*16,h=e+16*(Math.ceil(t/2)-1)-16*parseInt((i-1)/2);this.wallCtx.fillRect(s,h,14,14)}},this.drawLives=function(t,i){var e=272;2==i&&(e=320),this.wallCtx.fillStyle="#7f7f7f",this.wallCtx.fillRect(482,e,this.num.size,this.num.size),this.num.draw(t,482,e)},this.updateMap=function(t,i){if(null!=t&&0<t.length)for(var e=t.length,s=0;s<e;s++){var h=t[s];0<(this.mapLevel[h[0]][h[1]]=i)?this.wallCtx.drawImage(RESOURCE_IMAGE,this.tileSize*(i-1)+POS.map[0],POS.map[1],this.tileSize,this.tileSize,h[1]*this.tileSize+this.offsetX,h[0]*this.tileSize+this.offsetY,this.tileSize,this.tileSize):(this.wallCtx.fillStyle="#000",this.wallCtx.fillRect(h[1]*this.tileSize+this.offsetX,h[0]*this.tileSize+this.offsetY,this.tileSize,this.tileSize))}},this.homeHit=function(){this.wallCtx.drawImage(RESOURCE_IMAGE,POS.home[0]+this.homeSize,POS.home[1],this.homeSize,this.homeSize,12*this.tileSize+this.offsetX,24*this.tileSize+this.offsetY,this.homeSize,this.homeSize)}};